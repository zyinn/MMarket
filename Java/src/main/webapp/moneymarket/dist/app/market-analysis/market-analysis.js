!function(e){"use strict";function t(t,r,a){var i=this;i.state="inner",i.isInit=!1,i.chartShow=!1,i.chartData=[],i.row=2,i.col=4,a.current.name="app.innerFinancing.index",i.innerDirection=[{name:"出理财",id:"OUT"},{name:"收理财",id:"IN"}],i.offlineDirection=[{name:"出资金",id:"OUT"},{name:"收资金",id:"IN"}],i.quoteTypeList=[{name:"保本",id:"GTF"},{name:"非保R2",id:"UR2"},{name:"非保R3",id:"UR3"}],i.BankNature=[{name:"SHIBOR",fundSize:"NONE",displayName:"Shibor"},{name:"BIG_BANK",fundSize:"NONE",displayName:"大行"},{name:"JOINT_STOCK",fundSize:"NONE",displayName:"股份制"},{name:"CITY_COMMERCIAL_BANK",fundSize:"LARGER_FIVE_T",displayName:"城农商(>5000亿)"},{name:"CITY_COMMERCIAL_BANK",fundSize:"ONE_FIVE_T",displayName:"城农商(1000-5000亿)"},{name:"CITY_COMMERCIAL_BANK",fundSize:"SMALLER_ONE_T",displayName:"城农商(<1000亿)"},{name:"OTHERS",fundSize:"NONE",displayName:"其他"}],i.FIperiodList=[{name:""},{name:"1D(T+0)"},{name:"1M"},{name:"2M"},{name:"3M"},{name:"6M"},{name:"9M"},{name:"1Y"}],i.CDperiodList=[{name:""},{name:"1D(T+0)"},{name:"7D"},{name:"14D"},{name:"1M"},{name:"2M"},{name:"3M"},{name:"6M"},{name:"9M"},{name:"1Y"}],i.initFilter=function(){i.boardDirection.forEach(function(e){e.selected=!1}),i.quoteTypeList.forEach(function(e){e.selected=!1}),"inner"===i.state?(i.boardDirection[0].selected=!0,i.quoteTypeList[1].selected=!0):"offline"===i.state&&(i.boardDirection[1].selected=!0)},i.initPage=function(r){i.isInit=!1,t.getData(i.direction,i.quoteType).success(function(t){if(i.matrixData=e.copy(i.BankNature),t.result&&Array.isArray(t.result)){if(0===t.result.length)return;t.result.forEach(function(e){i.matrixData.forEach(function(t){e.matrixBankNature===t.name&&(e.matrixFundSize&&e.matrixFundSize===t.fundSize?t.rowDtoList=e.rowDtoList:"NONE"===e.matrixFundSize&&(t.rowDtoList=e.rowDtoList))})}),i.initTd=function(){i.matrixData.forEach(function(e){e.rowDtoList.forEach(function(e){e.selected=!1})})},i.initTd(),i.matrixData[i.row].rowDtoList[i.col].isSelected=!0,r&&i.matrixClick(void 0,i.matrixData[i.row],i.matrixData[i.row].rowDtoList[i.col])}i.isInit=!0})},i.matrixClick=function(e,t,r){i.matrixBankNature=t.name,i.matrixFundSize=t.fundSize,i.timePeriod=r.timePeriod,i.getChart(),i.matrixData.forEach(function(e){e.rowDtoList.forEach(function(e){e.isSelected=!1})}),r.isSelected=!0,i.row=i.matrixData.indexOf(t),i.rowName=i.BankNature[i.row].displayName,i.col=t.rowDtoList.indexOf(r),"inner"===i.state?i.colName=i.FIperiodList[i.col+1].name:"offline"===i.state&&(i.colName=i.CDperiodList[i.col+1].name)},i.tabChange=function(e){var t=e.target;"LI"===t.nodeName&&(jQuery(t).hasClass("active")||(jQuery(t).hasClass("inner")?(i.state="inner",i.row=2,i.col=4,i.boardDirection=i.innerDirection,a.current.name="app.innerFinancing.index",i.direction="OUT",i.quoteType="UR2"):jQuery(t).hasClass("offline")&&(i.state="offline",i.row=2,i.col=6,i.boardDirection=i.offlineDirection,a.current.name="app.offlineFinancing.index",i.direction="IN",i.quoteType="IBD"),i.initFilter(),i.initPage(!0),i.refreshMatrix()))},i.changeDirection=function(e,t){var r=e.target;jQuery(r).hasClass("selected")||(i.boardDirection.forEach(function(e){e.selected=!1}),t.selected=!0,i.direction=t.id,i.initPage(!0),i.refreshMatrix())},i.changeType=function(e,t){var r=e.target;jQuery(r).hasClass("selected")||(i.quoteTypeList.forEach(function(e){e.selected=!1}),t.selected=!0,i.quoteType=t.id,i.initPage(!0),i.refreshMatrix())};var n;i.refreshMatrix=function(){n&&r.cancel(n),n=r(function(){i.initPage(!1)},6e4)},i.getChart=function(){t.getChart(i.direction,i.quoteType,i.matrixBankNature,i.matrixFundSize,i.timePeriod,90).success(function(e){e.result&&Array.isArray(e.result)&&(0===e.result.length?(i.chartShow=!0,i.chartData=i.mockData):(i.chartShow=!0,e.result.forEach(function(e){if(e.createTime&&"number"==typeof e.createTime){var t=new Date;t.setTime(e.createTime),e.createTime=t.format("MM-dd")}}),i.chartData=e.result),i.makeChart())})},i.boardDirection=i.innerDirection,i.direction="OUT",i.quoteType="UR2",i.initFilter(),i.initPage(!0),i.refreshMatrix(),i.makeChart=function(){var e=AmCharts.makeChart("market-charts",{type:"serial",theme:"black",color:"#ffebc8",backgroundAlpha:0,backgroundColor:"#222222",plotAreaFillAlphas:1,plotAreaFillColors:"#161819",marginTop:10,categoryField:"createTime",mouseWheelZoomEnabled:!0,categoryAxis:{showFirstLabel:!0,showLastLabel:!0,minorGridAlpha:.1,minorGridEnabled:!0,color:"#bacdc9",gridAlpha:.8,gridColor:"#494949",gridPosition:"middle",axisAlpha:1,axisColor:"#494949"},valueAxes:[{color:"#bacdc9",title:"收益率（%）",titleFontSize:10,titleColor:"#878787",titleBold:!1,titlePosition:"bottom",axisAlpha:1,axisColor:"#494949",gridAlpha:.8,gridColor:"#494949"}],dataProvider:i.chartData,legend:{useGraphSettings:!0,fontSize:12,color:"#ffebc8",enabled:!0,markerType:"line",markerBorderThickness:2,valueText:"[[]]",valueWidth:0,divId:"marketCharts"},graphs:[{title:"下区间",balloonText:"",bullet:"round",bulletAlpha:1,bulletSize:5,cursorBulletAlpha:1,lineColor:"#b59e5c",lineThickness:2,type:"line",valueField:"priceLow"},{title:"上区间",balloon:{borderAlpha:0,fillAlpha:1,fillColor:"#ffedcd",fontSize:13},balloonText:"<div style='text-align: center;'>[[category]]</br>收益率：<b>[[priceLow]]-[[priceHigh]]</b></div>",bullet:"square",bulletAlpha:1,bulletSize:5,cursorBulletAlpha:1,lineColor:"#d1655d",lineThickness:2,type:"line",valueField:"priceHigh"}],chartScrollbar:{color:"transparent",scrollbarHeight:20,backgroundColor:"#161819",backgroundAlpha:1,selectedBackgroundAlpha:1,selectedBackgroundColor:"#393939",dragIcon:"dragIconRectSmallBlack",dragIconHeight:27,dragIconWidth:23,gridAlpha:0,autoGridCount:!0,oppositeAxis:!1,offset:30},chartCursor:{cursorAlpha:.5,cursorColor:"#979797",valueLineEnabled:!0,valueLineBalloonEnabled:!1,valueLineAlpha:.5,valueLineColor:"#fff",categoryBalloonEnabled:!1,categoryBalloonAlpha:.5,categoryBalloonColor:"#fff",fullWidth:!1,cursorPosition:"middle",bulletsEnabled:!0,bulletSize:8,categoryBalloonDateFormat:"MM-DD"}});i.chartData.length>29&&e.zoomToIndexes(Math.round(2*i.chartData.length/3),i.chartData.length)},i.time=function(e){var t=new Date;return t.setDate((new Date).getDate()-e),t=t.format("MM-dd")},i.mockData=[{priceLow:0,priceHigh:null,createTime:i.time(1)}]}e.module("directives",[]),e.module("services",[]),e.module("moneyMarketApp",["directives","services","ngCookies","ui.router","ui.bootstrap","oc.lazyLoad"]);var r=e.module("moneyMarketApp");r.factory("userInterceptor",["$q","$injector","appConfig","$cookies",function(e,t,r,a){var i=function(e){return!/(\.html|\.js|\.json|ui\-grid|validateUser|service)/.test(e)};return{request:function(e){return i(e.url)&&(e.headers.username=a.get("username"),e.headers.password=a.get("password")),e},requestError:function(e){return e},response:function(a){if(i(a.config.url)){var n=a.data;if(a.config.url.endWith(r.get_brother_alliance))return a;if(0===n.return_code)return a;if(n.return_message){var o=t.get("bootbox");o.message(n.return_message.exceptionName+"\n"+n.return_message.exceptionMessage,n.return_message.exceptionStackTrace)}return e.reject(a)}return a},responseError:function(t){return e.reject(t)}}}]).config(["$httpProvider","$injector",function(e,t){e.interceptors.push("userInterceptor")}]),r.controller("marketController",t),t.$inject=["marketService","$interval","$state"]}(angular);